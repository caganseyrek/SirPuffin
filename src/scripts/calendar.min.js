import specialdays from"../data/specialdays.json"assert{type:"json"};const calendarElement=document.getElementById("calendar"),calendarTitle=document.getElementById("calendartitle"),weekdayHeaders=document.getElementById("weekdays"),smallCalendarElement=document.getElementById("smallcalendar"),modalBackground=document.getElementById("modalbackground"),modalContainer=document.getElementById("modalcontainer"),modalTitle=document.getElementById("modaltitle"),modalContent=document.getElementById("modalcontent"),weekdaysEnglish=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysTurkish=["Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi","Pazar"],months=["January","February","March","April","May","June","July","August","September","October","November","December"];var currentMonthCounter=0,currentYearCounter=0,modalState=!1,currentTheme="Light",currentFirstDay="Monday";function renderCalendar(){calendarElement.textContent="",calendarTitle.textContent="",weekdayHeaders.textContent="",smallCalendarElement.textContent="";var e=new Date,t=(0!==currentMonthCounter&&e.setMonth((new Date).getMonth()+currentMonthCounter),0!==currentYearCounter&&((t=(new Date).getFullYear()+currentYearCounter)<1?t=1:9999<t?t=9999:e.setFullYear(t)),e.getMonth()),n=e.getFullYear(),a=e.getDate(),d=(new Date).toLocaleDateString("en-uk",{month:"long"}),o=(new Date).toLocaleDateString("en-uk",{year:"numeric"}),e=new Date(n,t,1),r=new Date(n,t+1,1),l=new Date(n,t,0).getDate(),i=new Date(n,t+1,0).getDate(),t=e.toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"numeric",day:"numeric"});const c=e.toLocaleDateString("en-TR",{month:"long"});var s=r.toLocaleDateString("en-TR",{month:"long"});const m=weekdaysTurkish.indexOf(t.split(" ")[1]);e=document.createElement("b"),e.textContent=c+" ",r=document.createElement("span");r.textContent=n.toString(),calendarTitle.appendChild(e),calendarTitle.appendChild(r),document.title=c+" "+n.toString()+" - SirPuffin";for(let e=0;e<=6;e++){var u=document.createElement("div"),u=(u.textContent=weekdaysEnglish[e].slice(0,3),weekdayHeaders.appendChild(u),document.createElement("div"));u.textContent=weekdaysEnglish[e].charAt(0),u.classList.add("scday"),u.classList.add("header"),smallCalendarElement.appendChild(u)}var p=1,C=1;for(let e=1;e<=6;e++){var h=document.createElement("tr");for(let e=1;e<=7;e++){const v=document.createElement("td");var y=document.createElement("div"),g=document.createElement("div"),E=document.createElement("div");y.classList.add("daylabel"),g.classList.add("dayevent"),E.classList.add("scday"),p<=m?(y.textContent=(l-(m-p)).toString(),v.classList.add("notcurrent"),E.textContent=(l-(m-p)).toString(),E.classList.add("scnotcurrent")):(y.textContent=(p-m).toString(),E.textContent=(p-m).toString(),p-m==1&&(y.textContent=c.slice(0,3)+" "+(p-m)),p-m===a&&d===c&&n.toString()===o&&(y.classList.add("today"),E.classList.add("today"))),p>i+m&&(y.textContent=C.toString(),1===C&&(y.textContent=s.slice(0,3)+" "+C.toString()),v.classList.add("notcurrent"),E.textContent=C.toString(),E.classList.add("scnotcurrent"),C++),v.appendChild(y),v.appendChild(g),specialdays.forEach(e=>{var t=(p-m).toString();e.date.split(" ")[1]===c&&e.date.split(" ")[0]===t&&((t=document.createElement("div")).setAttribute("class","specialdayevent"),t.textContent=e.title,t.addEventListener("click",()=>{openModal("specialday",null,e)}),v.appendChild(t))}),h.appendChild(v),smallCalendarElement.appendChild(E),p++}calendarElement.appendChild(h),renderEvents()}}function renderEvents(){}function jumpToDate(){var e,t=document.getElementById("jumpyearinput"),n=document.getElementById("jumpmonthdropdown");modalContainer.querySelectorAll("div.errorprompt").forEach(e=>{modalContainer.removeChild(e)}),""===t.value?((e=document.createElement("div")).classList.add("errorprompt"),e.textContent="Invalid date. Please try again.",modalContainer.append(e)):t.value<1||9999<t.value?((e=document.createElement("div")).classList.add("errorprompt"),e.textContent="The year must be between 1-9999. Please try again.",modalContainer.append(e),t.value<1?t.value=1:9999<t&&(t.value=9999)):(e=(new Date).getMonth(),n=months.indexOf(n.value)+1-(e+1),e=(new Date).getFullYear(),t=t.value-e,currentMonthCounter=n,currentYearCounter=t,renderCalendar(),modalState&&closeModal())}function openModal(e,t,n){var a=document.createElement("h2"),d=document.createElement("div"),o=(d.setAttribute("id","dateselectiongrid"),document.createElement("select"));o.setAttribute("class","dropdown");for(let e=0;e<12;e++){var r=(new Date).getFullYear(),r=new Date(r,e).toLocaleTimeString("en-uk",{month:"long"}),l=document.createElement("option");l.textContent=r.split(" ")[0],o.appendChild(l)}var i,c,s,m,u,p,C,h,y=document.createElement("input"),y=(y.setAttribute("type","number"),y.setAttribute("class","modalinput"),document.createElement("input"));y.setAttribute("type","number"),y.setAttribute("class","modalinput"),"settings"===e&&(a.textContent="Settings",modalTitle.appendChild(a),h=document.createElement("span"),c=document.createElement("span"),h.textContent="Calendar Theme",c.textContent="First Day of the Week",(C=document.createElement("select")).setAttribute("class","dropdown"),C.setAttribute("id","themeselector"),i=document.createElement("option"),u=document.createElement("option"),i.textContent="Dark",u.textContent="Light",(s=document.createElement("select")).setAttribute("class","dropdown"),s.setAttribute("id","firstdayselector"),m=document.createElement("option"),p=document.createElement("option"),m.textContent="Monday",p.textContent="Sunday",C.appendChild(u),C.appendChild(i),s.appendChild(m),s.appendChild(p),u="Light"===localStorage.getItem("theme")?0:1,i="Monday"===localStorage.getItem("firstday")?0:1,C.selectedIndex=u,s.selectedIndex=i,(m=document.createElement("div")).setAttribute("class","modalrow"),m.appendChild(h),m.appendChild(C),(p=document.createElement("div")).setAttribute("class","modalrow"),p.appendChild(c),p.appendChild(s),(u=document.createElement("a")).setAttribute("id","settingaction"),u.textContent="Save Settings",u.addEventListener("click",()=>{var e=document.getElementById("themeselector").value,t=document.getElementById("firstdayselector").value;localStorage.setItem("theme",e.toString()),localStorage.setItem("firstday",t.toString()),loadSettings()}),modalContent.appendChild(m),modalContent.appendChild(p),modalContent.appendChild(u)),"specialday"===e&&(a.textContent=(i=n).title,modalTitle.appendChild(a),h=document.createElement("div"),C=document.createElement("div"),c=document.createElement("div"),(s=document.createElement("div")).setAttribute("class","specialdayinfo"),h.textContent=i.localname,C.textContent=i.date,c.textContent=i.celebratedin,s.textContent=i.extrainfo,m=document.createElement("div"),(p=document.createElement("div")).setAttribute("class","boldtext"),p.textContent="Local Name",m.setAttribute("class","modalrow bordertop"),m.appendChild(p),m.appendChild(h),u=document.createElement("div"),(n=document.createElement("div")).setAttribute("class","boldtext"),n.textContent="Date",u.setAttribute("class","modalrow"),u.appendChild(n),u.appendChild(C),p=document.createElement("div"),(h=document.createElement("div")).setAttribute("class","boldtext"),h.textContent="Celebrated in",p.setAttribute("class","modalrow"),p.appendChild(h),p.appendChild(c),modalContent.appendChild(m),modalContent.appendChild(u),modalContent.appendChild(p),null!==i.extrainfo)&&(n=document.createElement("div"),(C=document.createElement("div")).setAttribute("class","boldtext"),C.textContent="Extra information",n.setAttribute("class","modalrow bordertop"),n.appendChild(C),n.appendChild(s),modalContent.appendChild(n)),"jumpToDate"===e&&(a.textContent="Jump to Date",modalTitle.appendChild(a),y.value=(new Date).getFullYear(),(h=document.createElement("a")).setAttribute("id","jumpaction"),h.textContent="Jump!",h.addEventListener("click",()=>{jumpToDate()}),o.setAttribute("id","jumpmonthdropdown"),y.setAttribute("id","jumpyearinput"),d.appendChild(y),d.appendChild(o),d.appendChild(h),modalContent.appendChild(d)),"newEvent"===e&&(a.textContent="Add New Event",modalTitle.appendChild(a)),modalBackground.style.display="flex",modalState=!0}function closeModal(){modalContainer.querySelectorAll("div.errorprompt").forEach(e=>{modalContainer.removeChild(e)}),modalContent.textContent="",modalTitle.textContent="",modalBackground.style.display="none",modalState=!1}function loadSettings(){var e=localStorage.getItem("theme"),t=localStorage.getItem("firstday");null!==e&&null!==t||(localStorage.setItem("theme","Light"),localStorage.setItem("firstday","Monday")),currentTheme!==e&&(document.body.classList.toggle("darkmode"),currentTheme="Light"===currentTheme?"Dark":"Light",localStorage.setItem("theme",currentTheme)),currentFirstDay!==t&&("Sunday"===weekdaysEnglish[0]||"Pazar"===weekdaysTurkish[0]?(e=weekdaysEnglish.reverse().pop(),t=weekdaysTurkish.reverse().pop(),weekdaysEnglish.reverse().push(e),weekdaysTurkish.reverse().push(t)):(e=weekdaysEnglish.pop(),t=weekdaysTurkish.pop(),weekdaysEnglish.unshift(e),weekdaysTurkish.unshift(t)),currentFirstDay="Monday"===currentFirstDay?"Sunday":"Monday",localStorage.setItem("firstday",currentFirstDay)),renderCalendar()}function initButtons(){document.getElementById("nextbtn").addEventListener("click",()=>{currentMonthCounter++,renderCalendar()}),document.getElementById("prevbtn").addEventListener("click",()=>{currentMonthCounter--,renderCalendar()}),document.getElementById("todaybtn").addEventListener("click",()=>{currentYearCounter=currentMonthCounter=0,renderCalendar()}),document.getElementById("jumpbtn").addEventListener("click",()=>{openModal("jumpToDate")}),document.getElementById("settingsbtn").addEventListener("click",()=>{openModal("settings")}),document.getElementById("closebtn").addEventListener("click",()=>{closeModal()})}function initShortcuts(){document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":currentMonthCounter--,renderCalendar();break;case"ArrowRight":currentMonthCounter++,renderCalendar()}}),document.addEventListener("keyup",e=>{modalState&&"Escape"===e.key&&closeModal()})}window.onload=()=>{loadSettings(),renderCalendar(),initButtons(),initShortcuts()};